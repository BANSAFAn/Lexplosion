<UserControl
    x:Class="Lexplosion.UI.WPF.Mvvm.Views.Pages.MainContent.MainMenu.FindFriendsView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Lexplosion.UI.WPF.Controls"
    xmlns:converters="clr-namespace:Lexplosion.UI.WPF.Core.Converters"
    xmlns:core="clr-namespace:Lexplosion.UI.WPF.Core"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:extensions="clr-namespace:Lexplosion.UI.WPF.Extensions"
    xmlns:lexplosion="clr-namespace:Lexplosion;assembly=Lexplosion.Core"
    xmlns:local="clr-namespace:Lexplosion.UI.WPF.Mvvm.Views.Pages.MainContent.MainMenu"
    xmlns:mainmenu="clr-namespace:Lexplosion.UI.WPF.Mvvm.ViewModels.MainContent.MainMenu"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:objects="clr-namespace:Lexplosion.UI.WPF.Core.Objects"
    xmlns:userComponents="clr-namespace:Lexplosion.UI.WPF.ViewComponents.Users"
    xmlns:users="clr-namespace:Lexplosion.UI.WPF.Core.Objects.Users"
    d:DataContext="{d:DesignInstance Type=mainmenu:FindFriendsViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <core:BindingProxy x:Key="ViewModel" Data="{Binding}" />

        <DataTemplate DataType="{x:Type users:NightWorldUser}">
            <userComponents:NightWorldUser
                Margin="0,0,4,4"
                Avatar="{Binding AvatarUrl}"
                Banner="{Binding Banner}"
                Nickname="{Binding Login}"
                RunningClientName="{Binding RunningClientName}"
                Status="{Binding Status.Value}"
                ViewModelDataContext="{Binding Data, Source={StaticResource ViewModel}}" />
        </DataTemplate>
    </UserControl.Resources>

    <Grid>

        <Grid Margin="32,16">

            <!--  Triggers  -->
            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <!--  Loading Blue Effect  -->
                        <DataTrigger Binding="{Binding Model.IsLoading}" Value="True">
                            <Setter Property="Effect">
                                <Setter.Value>
                                    <BlurEffect />
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>


            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>


            <!--  SearchBox & Filters  -->
            <controls:SearchBox
                Margin="0,0,0,12"
                HorizontalAlignment="Stretch"
                Placeholder="{DynamicResource TypingNicknamePlaceholder}"
                SearchCommand="{Binding SearchCommand}"
                Style="{StaticResource sm-searchbox-default}" />

            <!--  Users List  -->
            <ListBox
                x:Name="UsersList"
                Grid.Row="1"
                Margin="0,0,0,8"
                HorizontalAlignment="Stretch"
                ItemsSource="{Binding Model.Users}"
                Style="{StaticResource TransparentListBox}">

                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel
                            HorizontalAlignment="Stretch"
                            IsItemsHost="True"
                            VirtualizingPanel.CacheLengthUnit="Item"
                            VirtualizingPanel.IsVirtualizing="True" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>

            </ListBox>

            <!--  Paginator  -->
            <controls:Paginator
                Grid.Row="2"
                CurrentPageIndex="{Binding Model.CurrentPageIndex}"
                NextCommand="{Binding MoveNextPageCommand}"
                PageCount="{Binding Model.PageCount}"
                PrevCommand="{Binding MovePrevPageCommand}" />
        </Grid>

        <controls:Empty CollectionCount="{Binding Model.Users.Count}" Description="{DynamicResource WeDidNotFindAnythingForThisRequest}" />

        <controls:LoadingBoard
            Background="Black"
            BackgroundOpacity="0.3"
            IsActive="{Binding Model.IsLoading}"
            Placeholder="{DynamicResource LoadingEllipsis}" />
    </Grid>
</UserControl>
